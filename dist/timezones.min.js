/*!
 * timezones - A jQuery plugin to turn a select box into a timezone selector
 * v0.0.1
 * https://github.com/jgallen23/timezones
 * copyright Greg Allen 2013
 * MIT License
*/
!function(){function a(a){function c(a){a+="";var b=a.split(":"),c=~a.indexOf("-")?-1:1,d=Math.abs(+b[0]),e=parseInt(b[1],10)||0,f=parseInt(b[2],10)||0;return c*(60*d+e+f/60)}function d(a,b,d,e,f,g,h,i,j,k){this.name=a,this.startYear=+b,this.endYear=+d,this.month=+e,this.day=+f,this.dayRule=+g,this.time=c(h),this.timeRule=+i,this.offset=c(j),this.letters=k||""}function e(a,b){this.rule=b,this.start=b.start(a)}function f(a,b){return a.isLast?-1:b.isLast?1:b.start-a.start}function g(a){this.name=a,this.rules=[]}function h(b,d,e,f,g,h){var i,j="string"==typeof g?g.split("_"):[9999];for(this.name=b,this.offset=c(d),this.ruleSet=e,this.letters=f,i=0;i<j.length;i++)j[i]=+j[i];this.until=a.utc(j).subtract("m",c(h))}function i(a,b){return a.until-b.until}function j(a){this.name=m(a),this.displayName=a,this.zones=[]}function k(a){var b,c,d;for(b in a)for(d=a[b],c=0;c<d.length;c++)l(b+"	"+d[c])}function l(a){if(w[a])return w[a];var b=a.split(/\s/),c=m(b[0]),e=new d(c,b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10]);return w[a]=e,q(c).add(e),e}function m(a){return(a||"").toLowerCase().replace(/\//g,"_")}function n(a){var b,c,d;for(b in a)for(d=a[b],c=0;c<d.length;c++)p(b+"	"+d[c])}function o(a){var b;for(b in a)A[m(b)]=m(a[b])}function p(a){if(y[a])return y[a];var b=a.split(/\s/),c=m(b[0]),d=new h(c,b[1],q(b[2]),b[3],b[4],b[5]);return y[a]=d,r(b[0]).add(d),d}function q(a){return a=m(a),x[a]||(x[a]=new g(a)),x[a]}function r(a){var b=m(a);return A[b]&&(b=A[b]),z[b]||(z[b]=new j(a)),z[b]}function s(a){a&&(a.zones&&n(a.zones),a.rules&&k(a.rules),a.links&&o(a.links))}var t,u=a.fn.zoneName,v=a.fn.zoneAbbr,w={},x={},y={},z={},A={},B=1,C=2,D=7,E=8;return d.prototype={contains:function(a){return a>=this.startYear&&a<=this.endYear},start:function(b){return b=Math.min(Math.max(b,this.startYear),this.endYear),a.utc([b,this.month,this.date(b),0,this.time])},date:function(a){return this.dayRule===D?this.day:this.dayRule===E?this.lastWeekday(a):this.weekdayAfter(a)},weekdayAfter:function(b){for(var c=this.day,d=a([b,this.month,1]).day(),e=this.dayRule+1-d;c>e;)e+=7;return e},lastWeekday:function(b){var c=this.day,d=c%7,e=a([b,this.month+1,1]).day(),f=a([b,this.month,1]).daysInMonth(),g=f+(d-(e-1))-7*~~(c/7);return d>=e&&(g-=7),g}},e.prototype={equals:function(a){return a&&a.rule===this.rule?Math.abs(a.start-this.start)<864e5:!1}},g.prototype={add:function(a){this.rules.push(a)},ruleYears:function(a,b){var c,d,g,h=a.year(),i=[];for(c=0;c<this.rules.length;c++)d=this.rules[c],d.contains(h)?i.push(new e(h,d)):d.contains(h+1)&&i.push(new e(h+1,d));return i.push(new e(h-1,this.lastYearRule(h-1))),b&&(g=new e(h-1,b.lastRule()),g.start=b.until.clone().utc(),g.isLast=b.ruleSet!==this,i.push(g)),i.sort(f),i},rule:function(a,b,c){var d,e,f,g,h,i=this.ruleYears(a,c),j=0;for(c&&(e=c.offset+c.lastRule().offset,f=9e4*Math.abs(e)),h=i.length-1;h>-1;h--)g=d,d=i[h],d.equals(g)||(c&&!d.isLast&&Math.abs(d.start-c.until)<=f&&(j+=e-b),d.rule.timeRule===C&&(j=b),d.rule.timeRule!==B&&d.start.add("m",-j),j=d.rule.offset+b);for(h=0;h<i.length;h++)if(d=i[h],a>=d.start&&!d.isLast)return d.rule;return t},lastYearRule:function(a){var b,c,d,e=t,f=-1e30;for(b=0;b<this.rules.length;b++)c=this.rules[b],a>=c.startYear&&(d=c.start(a),d>f&&(f=d,e=c));return e}},h.prototype={rule:function(a,b){return this.ruleSet.rule(a,this.offset,b)},lastRule:function(){return this._lastRule||(this._lastRule=this.rule(this.until)),this._lastRule},format:function(a){return this.letters.replace("%s",a.letters)}},j.prototype={zoneAndRule:function(a){var b,c,d;for(a=a.clone().utc(),b=0;b<this.zones.length&&(c=this.zones[b],!(a<c.until));b++)d=c;return[c,c.rule(a,d)]},add:function(a){this.zones.push(a),this.zones.sort(i)},format:function(a){var b=this.zoneAndRule(a);return b[0].format(b[1])},offset:function(a){var b=this.zoneAndRule(a);return-(b[0].offset+b[1].offset)}},a.updateOffset=function(a){var b;a._z&&(b=a._z.offset(a),Math.abs(b)<16&&(b/=60),a.zone(b))},a.fn.tz=function(b){return b?(this._z=r(b),this._z&&a.updateOffset(this),this):this._z?this._z.displayName:void 0},a.fn.zoneName=function(){return this._z?this._z.format(this):u.call(this)},a.fn.zoneAbbr=function(){return this._z?this._z.format(this):v.call(this)},a.tz=function(){var b,c=[],d=arguments.length-1;for(b=0;d>b;b++)c[b]=arguments[b];return a.apply(null,c).tz(arguments[d])},a.tz.add=s,a.tz.addRule=l,a.tz.addZone=p,a.tz.version=b,t=l("- 0 9999 0 0 0 0 0 0"),a}var b="0.0.1";"function"==typeof define&&define.amd?define("moment-timezone",["moment"],a):"undefined"!=typeof window&&window.moment?a(window.moment):"undefined"!=typeof module&&(module.exports=a(require("moment")))}.apply(this),function(a){var b={init:function(a){this.cities=a,this.html=this.getHTMLOptions(),this.currentTimezone=this.getCurrentTimezoneKey()},getHTMLOptions:function(){var b="",c=0;return a.each(this.cities,function(a){c=moment.tz(a).format("Z"),b+='<option data-offset="'+c+'" value="'+a+'">(GMT '+c+") "+a+"</option>"}),b},addNames:function(b){return a(b).empty().append(a(this.html))},selectValue:function(b,c){c=c||this.currentTimezone;var d=a(b).find('option[data-offset="'+c+'"]');return d.length&&a(b).val(d.val()),a(b)},getCurrentTimezoneKey:function(){return moment().format("Z")}};a.fn.timezones=function(c){return c=a.extend({},a.fn.timezones.defaults,c),moment.tz.add(c.tz),b.init(c.tz.zones),this.each(function(){return b.addNames(this),b.selectValue(this),this})},a.fn.timezones.defaults={tz:{zones:[]}}}(jQuery);